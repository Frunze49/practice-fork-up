## TLDR Что было сделано?
- Написали компораторы для бинарных и xml-файлов
- Написали программы для фаззинг-теста xml2bin и bin2xml
- Нашли и исправили баги в решении


## Найденные баги
- \[bin2xml\] проверка, что бинарные данные на входе выровнены по 128
- \[bin2xml\] проверка, что string содержат человекочитаемые символы, их длина >0 и что они не содержат управляющие символы
- \[bin2xml\] проверка, что оценка за практику только 0 или 1
- \[bin2xml\] проверка, что итогая оценка может быть валидно представлена как floating-point тип
- \[xml2bin\] проверка валидности xml-формата была неявной
- \[xml2bin\] проверка, что представлены все данные
- \[xml2bin\] проверка, что строковые данные помещаются в соответствующий массив с фиксированным размером

В случае битых входных данных теперь выбрасывается исключение с ошибкой `ParseException` (префикс сообщения исключения содержки `Malformed input в stderr`).

Также, стоит иметь в виду, что floating-point значения могут быть причиной нарушения round-trip guarantee, так как мы не всегда можем с полной точностью показывать дробную часть в строковом представлении. 
Поэтому считаем, что такие диффы не нарушают требуемую гарантию.

## Струтура директорий
- `SourceProject/` - исходное решение, которое тестируем и исправляем
- `XmlFmt/` - исправленное решение
    - `test_bin/` - тестовые данные для bin->xml->bin
    - `test_xml/` - тестовые данные для xml->bin->xml
- `FuzzBinToXml/` - фаззинг-тест, проверяющий round-trip guarantee для C-формата (bin->xml->bin)
    - `findings/` - найденные краши
    - `script/` - скрипт для запуска фаззинга
    - `testcases/` - тестовые данные
- `FuzzXmlToBin/` - фаззинг-тест, проверяющий round-trip guarantee для xml (xml->bin->xml)
    - содержимое аналогично `FuzzBinToXml/`

## Как фаззим
Для фаззинга используется [sharpfuzz](https://github.com/Metalnem/sharpfuzz). 
- BinToXml фаззим из директории `FuzzBinToXml/` командой:

    ```pwsh script/fuzz.ps1 FuzzBinToXml.csproj -i testcases```
- Для фаззинга XmlToBin пользуемся аналогичной командой из соответствующей директории:

    ```pwsh script/fuzz.ps1 FuzzXmlToBin.csproj -i testcases -x dictionaries/xml.dict```

И для `FuzzBinToXml`, и для `FuzzXmlToBin` процессы идентичные.
Будем рассматривать что происходит на примере `FuzzBinToXml`: 
- входные фаззинг-данные записываются в файл `test.bin`, они парсятся в xml-формат в файл `intra.xml` и переводятся обратно в `result.bin`; 
- далее мы проверяем, что содержимое test.bin и result.bin совпадает; 
- если нет, то тест крашится.

Фаззили в обе стороны по часу:

- bin2xml
![bin2xml](data/bin2xml.png?raw=true "Title")

- xml2bin
![xml2bin](data/xml2bin.png?raw=true "Title")

## Про исправленное решение
Собрать исправленное решение можно командой `dotnet build`.
Код может:
1. перевести bin->xml или xml->bin:

    ``` bin/Debug/net8.0/XmlFmt test_XXX/test.XXX```

2. перевести bin->xml->bin или xml->bin->xml и сравнивать файлы на round-trip guarantee:

    ``` bin/Debug/net8.0/XmlFmt test_XXX/test.XXX cmp ```

Где `XXX` = `bin`/`xml` (в зависимости от того, что проверяем)